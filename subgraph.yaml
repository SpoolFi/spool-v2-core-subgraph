specVersion: 0.0.4
description: Spool V2 Core Subgraph
repository: 
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: StrategyRegistry
    network: mainnet
    source:
      address: '0x05bB67cB592C1753425192bF8f34b95ca8649f09'
      abi: StrategyRegistryContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/strategyRegistry.ts
      entities:
        - Token
        - AssetGroup
        - Strategy
      abis:
        - name: StrategyRegistryContract
          file: ./abis/StrategyRegistry.json
        - name: StrategyContract
          file: ./abis/IStrategy.json
      eventHandlers:
        - event: StrategyRegistered(indexed address)
          handler: handleStrategyRegistered
        - event: StrategyApyUpdated(indexed address,int256)
          handler: handleStrategyApyUpdated
        - event: StrategyDhw(indexed address,uint256,(uint256,uint256[],int256,uint256,uint256))
          handler: handleStrategyDhw
  - kind: ethereum/contract
    name: RiskManager
    network: mainnet
    source:
      address: '0xA75E74a5109Ed8221070142D15cEBfFe9642F489'
      abi: RiskManagerContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/riskManager.ts
      entities:
        - Token
        - AssetGroup
        - Strategy
        - SmartVault
      abis:
        - name: RiskManagerContract
          file: ./abis/RiskManager.json
      eventHandlers:
        - event: RiskScoresUpdated(indexed address,address[],uint8[])
          handler: handleRiskScoresUpdated
        - event: AllocationProviderSet(indexed address,indexed address)
          handler: handleAllocationProviderSet
        - event: RiskProviderSet(indexed address,indexed address)
          handler: handleRiskProviderSet
        - event: RiskToleranceSet(indexed address,int8)
          handler: handleRiskToleranceSet
  - kind: ethereum/contract
    name: AssetGroupRegistry
    network: mainnet
    source:
      address: '0xC220Ed128102d888af857d137a54b9B7573A41b2'
      abi: AssetGroupRegistryContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/assetGroupRegistry.ts
      entities:
        - AssetGroup
        - AssetGroupToken
        - Token
      abis:
        - name: AssetGroupRegistryContract
          file: ./abis/AssetGroupRegistry.json
        - name: BTokenContract
          file: ./abis/BToken.json
        - name: BTokenBytesContract
          file: ./abis/BTokenBytes32.json
      eventHandlers:
        - event: AssetGroupRegistered(indexed uint256)
          handler: handleAssetGroupRegistered
  - kind: ethereum/contract
    name: SpoolAccessControl
    network: mainnet
    source:
      address: '0x30426D33a78afdb8788597D5BFaBdADc3Be95698'
      abi: SpoolAccessControlContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/spoolAccessControl.ts
      entities:
        - RiskProvider
        - Strategy
        - StrategyRiskScore
      abis:
        - name: SpoolAccessControlContract
          file: ./abis/SpoolAccessControl.json
      eventHandlers:
        - event: RoleGranted(indexed bytes32,indexed address,indexed address)
          handler: handleRoleGranted
        - event: RoleRevoked(indexed bytes32,indexed address,indexed address)
          handler: handleRoleRevoked
  - kind: ethereum/contract
    name: SmartVaultManager
    network: mainnet
    source:
      address: '0x37D31345F164Ab170B19bc35225Abc98Ce30b46A'
      abi: SmartVaultManagerContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/smartVaultManager.ts
      entities:
        - SmartVault
        - AssetGroup
        - Strategy
        - RiskProvider
        - SmartVaultFees
        - SmartVaultStrategy
      abis:
        - name: SmartVaultManagerContract
          file: ./abis/SmartVaultManager.json
        - name: SmartVaultContract
          file: ./abis/SmartVault.json
      eventHandlers:
        - event: SmartVaultRegistered(indexed address,(uint256,address[],uint256,uint16,uint16,uint16))
          handler: handleSmartVaultRegistered
  - kind: ethereum/contract
    name: DepositManager
    network: mainnet
    source:
      address: '0x1bEfE2d8417e22Da2E0432560ef9B2aB68Ab75Ad'
      abi: DepositManagerContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/depositManager.ts
      entities:
        - User
        - SmartVaultDepositNFT
      abis:
        - name: DepositManagerContract
          file: ./abis/DepositManager.json
      eventHandlers:
        - event: DepositInitiated(indexed address,indexed address,indexed uint256,uint256,uint256[],address,address)
          handler: handleDepositInitiated
  - kind: ethereum/contract
    name: RewardManager
    network: mainnet
    source:
      address: '0x746a48E39dC57Ff14B872B8979E20efE5E5100B1'
      abi: RewardManagerContract
      startBlock: 17336473
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/rewardManager.ts
      entities:
        - SmartVaultRewardToken
        - SmartVaultRewardTokenUpdate
        - SmartVault
        - Token
      abis:
        - name: RewardManagerContract
          file: ./abis/RewardManager.json
        - name: BTokenContract
          file: ./abis/BToken.json
        - name: BTokenBytesContract
          file: ./abis/BTokenBytes32.json
      eventHandlers:
        - event: RewardAdded(indexed address,indexed address,uint256,uint256,uint256,uint256)
          handler: handleRewardAdded
        - event: RewardExtended(indexed address,indexed address,uint256,uint256,uint256,uint256,uint256)
          handler: handleRewardExtended
        - event: RewardRemoved(indexed address,indexed address)
          handler: handleRewardRemoved
