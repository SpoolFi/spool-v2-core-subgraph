specVersion: 0.0.4
description: Spool V2 Core Subgraph
repository: 
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: StrategyRegistry
    network: mainnet
    source:
      address: '0x79C42a0742733f61F110EaBAB2836397714AbBA1'
      abi: StrategyRegistryContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/strategyRegistry.ts
      entities:
        - Token
        - AssetGroup
        - Strategy
      abis:
        - name: StrategyRegistryContract
          file: ./abis/StrategyRegistry.json
        - name: StrategyContract
          file: ./abis/IStrategy.json
      eventHandlers:
        - event: StrategyRegistered(indexed address)
          handler: handleStrategyRegistered
        - event: StrategyApyUpdated(indexed address,int256)
          handler: handleStrategyApyUpdated
        - event: StrategyDhw(indexed address,uint256,(uint256,uint256[],int256,uint256,uint256))
          handler: handleStrategyDhw
  - kind: ethereum/contract
    name: RiskManager
    network: mainnet
    source:
      address: '0x2Eb2BBAAF8D16E8BA07BD40D141a7E25C6dD9945'
      abi: RiskManagerContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/riskManager.ts
      entities:
        - Token
        - AssetGroup
        - Strategy
        - SmartVault
      abis:
        - name: RiskManagerContract
          file: ./abis/RiskManager.json
      eventHandlers:
        - event: RiskScoresUpdated(indexed address,address[],uint8[])
          handler: handleRiskScoresUpdated
        - event: AllocationProviderSet(indexed address,indexed address)
          handler: handleAllocationProviderSet
        - event: RiskProviderSet(indexed address,indexed address)
          handler: handleRiskProviderSet
        - event: RiskToleranceSet(indexed address,int8)
          handler: handleRiskToleranceSet
  - kind: ethereum/contract
    name: AssetGroupRegistry
    network: mainnet
    source:
      address: '0xE831a22E1b09D2F25dae664BAe2EA45F8e257dd0'
      abi: AssetGroupRegistryContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/assetGroupRegistry.ts
      entities:
        - AssetGroup
        - AssetGroupToken
        - Token
      abis:
        - name: AssetGroupRegistryContract
          file: ./abis/AssetGroupRegistry.json
        - name: BTokenContract
          file: ./abis/BToken.json
        - name: BTokenBytesContract
          file: ./abis/BTokenBytes32.json
      eventHandlers:
        - event: AssetGroupRegistered(indexed uint256)
          handler: handleAssetGroupRegistered
  - kind: ethereum/contract
    name: SpoolAccessControl
    network: mainnet
    source:
      address: '0xEe54514745B056F07040CaCF801f59031D801431'
      abi: SpoolAccessControlContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/spoolAccessControl.ts
      entities:
        - RiskProvider
        - Strategy
        - StrategyRiskScore
      abis:
        - name: SpoolAccessControlContract
          file: ./abis/SpoolAccessControl.json
      eventHandlers:
        - event: RoleGranted(indexed bytes32,indexed address,indexed address)
          handler: handleRoleGranted
        - event: RoleRevoked(indexed bytes32,indexed address,indexed address)
          handler: handleRoleRevoked
  - kind: ethereum/contract
    name: SmartVaultManager
    network: mainnet
    source:
      address: '0x8e1f69CfFd8DaD657bF18B91D75BcD26CD6F43AC'
      abi: SmartVaultManagerContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/smartVaultManager.ts
      entities:
        - SmartVault
        - AssetGroup
        - Strategy
        - RiskProvider
        - SmartVaultFees
        - SmartVaultStrategy
        - SmartVaultFlush
      abis:
        - name: SmartVaultManagerContract
          file: ./abis/SmartVaultManager.json
        - name: SmartVaultContract
          file: ./abis/SmartVault.json
      eventHandlers:
        - event: SmartVaultRegistered(indexed address,(uint256,address[],uint256,uint16,uint16,uint16))
          handler: handleSmartVaultRegistered
        - event: SmartVaultFlushed(indexed address,uint256)
          handler: handleSmartVaultFlushed
  - kind: ethereum/contract
    name: DepositManager
    network: mainnet
    source:
      address: '0x8FCAC40e1302273Cac387696EBdaFf39FDfa172A'
      abi: DepositManagerContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/depositManager.ts
      entities:
        - User
        - SmartVaultDepositNFT
        - SmartVaultFlush
      abis:
        - name: DepositManagerContract
          file: ./abis/DepositManager.json
      eventHandlers:
        - event: DepositInitiated(indexed address,indexed address,indexed uint256,uint256,uint256[],address,address)
          handler: handleDepositInitiated
        - event: SmartVaultTokensClaimed(indexed address,indexed address,uint256,uint256[],uint256[])
          handler: handleSmartVaultTokensClaimed
  - kind: ethereum/contract
    name: WithdrawalManager
    network: mainnet
    source:
      address: '0x5C15f56Ee55531f011c6025B205c1750EA469f75'
      abi: WithdrawalManagerContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/withdrawalManager.ts
      entities:
        - User
        - SmartVaultWithdrawalNFT
        - SmartVaultFlush
      abis:
        - name: WithdrawalManagerContract
          file: ./abis/WithdrawalManager.json
      eventHandlers:
        - event: RedeemInitiated(indexed address,indexed address,indexed uint256,uint256,uint256,address)
          handler: handleRedeemInitiated
        - event: FastRedeemInitiated(indexed address,indexed address,uint256,uint256[],uint256[],uint256[])
          handler: handleFastRedeemInitiated
        - event: WithdrawalClaimed(indexed address,indexed address,uint256,uint256[],uint256[],uint256[])
          handler: handleWithdrawalClaimed
  - kind: ethereum/contract
    name: RewardManager
    network: mainnet
    source:
      address: '0x4060eF0D5a7F0633c5927F7E05041dd7Fcd95f42'
      abi: RewardManagerContract
      startBlock: 17549894
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      file: ./src/rewardManager.ts
      entities:
        - SmartVaultRewardToken
        - SmartVaultRewardTokenUpdate
        - SmartVault
        - Token
      abis:
        - name: RewardManagerContract
          file: ./abis/RewardManager.json
        - name: BTokenContract
          file: ./abis/BToken.json
        - name: BTokenBytesContract
          file: ./abis/BTokenBytes32.json
      eventHandlers:
        - event: RewardAdded(indexed address,indexed address,uint256,uint256,uint256,uint256)
          handler: handleRewardAdded
        - event: RewardExtended(indexed address,indexed address,uint256,uint256,uint256,uint256,uint256)
          handler: handleRewardExtended
        - event: RewardRemoved(indexed address,indexed address)
          handler: handleRewardRemoved
